<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Eady Â· BiGSTARS.jl</title><meta name="title" content="Eady Â· BiGSTARS.jl"/><meta property="og:title" content="Eady Â· BiGSTARS.jl"/><meta property="twitter:title" content="Eady Â· BiGSTARS.jl"/><meta name="description" content="Documentation for BiGSTARS.jl."/><meta property="og:description" content="Documentation for BiGSTARS.jl."/><meta property="twitter:description" content="Documentation for BiGSTARS.jl."/><meta property="og:url" content="https://subhk.github.io/BiGSTARSDocumentation/stable/literated/Eady/"/><meta property="twitter:url" content="https://subhk.github.io/BiGSTARSDocumentation/stable/literated/Eady/"/><link rel="canonical" href="https://subhk.github.io/BiGSTARSDocumentation/stable/literated/Eady/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">BiGSTARS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation_instructions/">Installation instructions</a></li><li><a class="tocitem" href="../../matrices/">Differentiation matrix</a></li><li><a class="tocitem" href="../../method/">Methodology</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../Stone1971/">Stone1971</a></li><li class="is-active"><a class="tocitem" href>Eady</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Basic-state"><span>Basic state</span></a></li><li><a class="tocitem" href="#Governing-equations"><span>Governing equations</span></a></li><li><a class="tocitem" href="#Normal-mode-solutions"><span>Normal-mode solutions</span></a></li><li><a class="tocitem" href="#Generalized-eigenvalue-problem"><span>Generalized eigenvalue problem</span></a></li><li><a class="tocitem" href="#Load-required-packages"><span>Load required packages</span></a></li><li><a class="tocitem" href="#Parameters"><span>Parameters</span></a></li><li><a class="tocitem" href="#Basic-state-2"><span>Basic state</span></a></li><li><a class="tocitem" href="#Constructing-Generalized-EVP"><span>Constructing Generalized EVP</span></a></li><li><a class="tocitem" href="#Eigenvalue-solver"><span>Eigenvalue solver</span></a></li><li><a class="tocitem" href="#Solving-the-Eady-problem"><span>Solving the Eady problem</span></a></li><li><a class="tocitem" href="#Result"><span>Result</span></a></li></ul></li><li><a class="tocitem" href="../rRBC/">rotating RBC</a></li></ul></li><li><a class="tocitem" href="../../contributing/">Contributor&#39;s Guide</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Eady</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Eady</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/subhk/BiGSTARS.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ï‚›</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/subhk/BiGSTARS.jl/blob/main/examples/Eady.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid">ï„</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h3 id="Linear-stability-analysis-of-baroclinic-instability-of-a-2D-front-based-on-Eady-(1949)"><a class="docs-heading-anchor" href="#Linear-stability-analysis-of-baroclinic-instability-of-a-2D-front-based-on-Eady-(1949)">Linear stability analysis of baroclinic instability of a 2D front based on Eady (1949)</a><a id="Linear-stability-analysis-of-baroclinic-instability-of-a-2D-front-based-on-Eady-(1949)-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-stability-analysis-of-baroclinic-instability-of-a-2D-front-based-on-Eady-(1949)" title="Permalink"></a></h3><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>Eady (1949) showed that in a uniformly sheared, stratified layer between two rigid lids on an <span>$f$</span>-plane, two counter-propagating Rossby edge waves can phase lock and convert available potential energy into kinetic energy, producing baroclinic eddies that grow fastest at wavelengths about four deformation radii and on timescales of a few days.</p><h2 id="Basic-state"><a class="docs-heading-anchor" href="#Basic-state">Basic state</a><a id="Basic-state-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-state" title="Permalink"></a></h2><p>The basic state is given by</p><p class="math-container">\[\begin{align}
    B(y, z) &amp;= Ri z - y, \\
    U(y, z) &amp;= z - {1}/{2},
\end{align}\]</p><p>where <span>$Ri$</span> is the Richardson number, and <span>$N^2 = Ri$</span> is the stratification.</p><h2 id="Governing-equations"><a class="docs-heading-anchor" href="#Governing-equations">Governing equations</a><a id="Governing-equations-1"></a><a class="docs-heading-anchor-permalink" href="#Governing-equations" title="Permalink"></a></h2><p>The non-dimensional form of the linearized version of the QG PV perturbation equation under the <span>$f$</span>-plane approximation can be expressed as,</p><p class="math-container">\[\begin{align}
    \frac{\partial q^\text{qg}}{\partial t} + U \frac{\partial q^\text{qg}}{\partial x} + \frac{\partial \psi}{\partial x}
    \frac{\partial Q^\text{qg}}{\partial y} = E \, \nabla_h^2 q^\text{qg},
\,\,\,\,\,\,\  \text{for} \,\,\, 0 &lt; z &lt;1,
\end{align}\]</p><p>where <span>$q^\text{qg}$</span> is the perturbation QG PV, and it is defined as</p><p class="math-container">\[\begin{align}
    q^\text{qg} = \nabla_h^2 \psi^\text{qg} +
    \frac{\partial}{\partial z}
    \left(\frac{1}{N^2} \frac{\partial \psi^\text{qg}}{\partial z}\right),
\end{align}\]</p><p>The variable <span>$\psi^\text{qg}$</span> describes the QG perturbation streamfunction with <span>$u^\text{qg}=-\partial_y \psi^\text{qg}$</span> and <span>$v^\text{qg}=\partial_x \psi^\text{qg}$</span>. The variable <span>$Q^\text{qg}$</span> describes the QG PV of the basic state, which is defined as \citep{pedlosky2013geophysical}</p><p class="math-container">\[\begin{align}
    Q^\text{qg} = -\frac{\partial U}{\partial y} + \frac{\partial}{\partial z}\left(\frac{B}{N^2} \right),
\end{align}\]</p><p>and the cross-front gradient of <span>$Q^\text{qg}$</span> is defined as</p><p class="math-container">\[\begin{align}
    \frac{\partial Q^\text{qg}}{\partial y} = - \frac{\partial}{\partial z}\left(\frac{\partial_z U}{N^2} \right).
\end{align}\]</p><p>The linearized perturbation buoyancy equation at the top and the bottom boundary is</p><p class="math-container">\[\begin{align}
    \frac{\partial b^\text{qg}}{\partial t} + U \frac{\partial b^\text{qg}}{\partial x}
      + \frac{\partial \psi^\text{qg}}{\partial x}
    \frac{\partial B}{\partial y} = 0,
    \,\,\,\,\,\,\ \text{at} \, z=0 \,\ \text{and} \,\, 1,
\end{align}\]</p><p>where <span>$b^\text{qg}=\partial_z \psi^\text{qg}$</span>.</p><h2 id="Normal-mode-solutions"><a class="docs-heading-anchor" href="#Normal-mode-solutions">Normal-mode solutions</a><a id="Normal-mode-solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Normal-mode-solutions" title="Permalink"></a></h2><p>Next, we seek normal-mode solutions for <span>$\psi^\text{qg}$</span> and <span>$q^\text{qg}$</span> in the form of</p><p class="math-container">\[\begin{align}
    [\psi^\text{qg}, q^\text{qg}] = \mathfrak{R}\big([\widetilde{\psi}^\text{qg},
  \widetilde{q}^\text{qg}] \big)(y, z) e^{i kx-\sigma t},
\end{align}\]</p><p>where <span>$\widetilde{\psi}^\text{qg}$</span>, <span>$\widetilde{q}^\text{qg}$</span> are the eigenfunctions of <span>$\psi^\text{qg}$</span> and <span>$q^\text{qg}$</span>, respectively. In terms of streamfunction <span>$\psi^\text{qg}$</span>,</p><p class="math-container">\[\begin{align}
    [(\sigma + i k U) - E] \mathscr{L}\widetilde{\psi}^\text{qg}
  + i k \partial_y Q^\text{qg} \widetilde{\psi}^\text{qg} &amp;= 0, \,\,\,\,\  \text{for} \,\, 0 &lt; z &lt;1,
\\
    (\sigma + i k U_{-})\partial_z \widetilde{\psi}^\text{qg}_{-}
  + i k \partial_y B_{-} \widetilde{\psi}^\text{qg}_{-} &amp;= 0, \,\,\,\,\, \text{at} \,\, z = 0,
\\
    (\sigma + i k U_{+})\partial_z \widetilde{\psi}^\text{qg}_{+}
  + i k \partial_y B_{+} \widetilde{\psi}^\text{qg}_{+} &amp;= 0, \,\,\,\,\, \text{at} \,\, z = 1,
\end{align}\]</p><p>where <span>$\mathscr{L}$</span> is a linear operator, and is defined as <span>$\mathscr{L} \equiv \mathcal{D}_h^2 + 1/N^2 \partial_z^2$</span>, where <span>$\mathcal{D}_h^2 = (\partial_y^2 - k^2)$</span>. The subscripts <span>$-,+$</span> denote the values of the fields at <span>$z=0$</span> and <span>$z=1$</span>, respectively.</p><h2 id="Generalized-eigenvalue-problem"><a class="docs-heading-anchor" href="#Generalized-eigenvalue-problem">Generalized eigenvalue problem</a><a id="Generalized-eigenvalue-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Generalized-eigenvalue-problem" title="Permalink"></a></h2><p>The above set of equations can be cast into a generalized eigenvalue problem</p><p class="math-container">\[\begin{align}
 AX= Î»BX,
\end{align}\]</p><p>where <span>$\lambda$</span> is the eigenvalue, and <span>$X$</span> is the eigenvector. The matrices <span>$A$</span> and <span>$B$</span> are given by</p><p class="math-container">\[\begin{align}
    A &amp;= \begin{bmatrix}
        ik U \mathcal{D}_0^2
       + ik \partial_y Q
      - E \mathcal{D}_h^2 \mathcal{D}_0^2
  \end{bmatrix},
  \,\,\,\,\,\,\,
    B &amp;= \begin{bmatrix}
      - \mathcal{D}_0^2
    \end{bmatrix},
\end{align}\]</p><p>where <span>$D_0^2 = \mathcal{D}_h^2 + (1/N^2) \mathcal{D}_z^2$</span>.</p><h2 id="Load-required-packages"><a class="docs-heading-anchor" href="#Load-required-packages">Load required packages</a><a id="Load-required-packages-1"></a><a class="docs-heading-anchor-permalink" href="#Load-required-packages" title="Permalink"></a></h2><pre><code class="language-julia hljs">using LazyGrids
using LinearAlgebra
using Printf
using StaticArrays
using SparseArrays
using SparseMatrixDicts
using FillArrays
using SpecialFunctions
using Parameters
using Test
using BenchmarkTools
using JLD2
using Parameters: @with_kw

using BiGSTARS
using BiGSTARS: AbstractParams
using BiGSTARS: Problem, OperatorI, TwoDGrid</code></pre><h2 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h2><pre><code class="language-julia hljs">@with_kw mutable struct Params{T} &lt;: AbstractParams
    L::T                = 1.0           # horizontal domain size
    H::T                = 1.0           # vertical domain size
    Ri::T               = 1.0           # the Richardson number
    k::T                = 0.1           # along-front wavenumber
    E::T                = 1.0e-12        # the Ekman number
    Ny::Int64           = 60            # no. of y-grid points
    Nz::Int64           = 30            # no. of z-grid points (should be different from Ny)
    eig_solver::String  = &quot;arpack&quot;      # eigenvalue solver
end</code></pre><h2 id="Basic-state-2"><a class="docs-heading-anchor" href="#Basic-state-2">Basic state</a><a class="docs-heading-anchor-permalink" href="#Basic-state-2" title="Permalink"></a></h2><pre><code class="language-julia hljs">function basic_state(grid, params)

    Y, Z = ndgrid(grid.y, grid.z)
    Y    = transpose(Y)
    Z    = transpose(Z)

    # Define the basic state
    Bâ‚€   = @. 1.0 * params.Ri * Z - Y    # buoyancy
    Uâ‚€   = @. 1.0 * Z - 0.5 * params.H   # along-front velocity

    # Calculate all the necessary derivatives
    deriv = compute_derivatives(Uâ‚€, Bâ‚€, grid.y, grid.Dá¶», grid.DÂ²á¶», :All)

    bs = initialize_basic_state_from_fields(Bâ‚€, Uâ‚€)

    initialize_basic_state!(
            bs,
            deriv.âˆ‚Ê¸Bâ‚€,  deriv.âˆ‚á¶»Bâ‚€,
            deriv.âˆ‚Ê¸Uâ‚€,  deriv.âˆ‚á¶»Uâ‚€,
            deriv.âˆ‚Ê¸Ê¸Uâ‚€, deriv.âˆ‚á¶»á¶»Uâ‚€, deriv.âˆ‚Ê¸á¶»Uâ‚€,
            deriv.âˆ‚Ê¸Ê¸Bâ‚€, deriv.âˆ‚á¶»á¶»Bâ‚€, deriv.âˆ‚Ê¸á¶»Bâ‚€
        )

    return bs, deriv
end</code></pre><h2 id="Constructing-Generalized-EVP"><a class="docs-heading-anchor" href="#Constructing-Generalized-EVP">Constructing Generalized EVP</a><a id="Constructing-Generalized-EVP-1"></a><a class="docs-heading-anchor-permalink" href="#Constructing-Generalized-EVP" title="Permalink"></a></h2><pre><code class="language-julia hljs">function generalized_EigValProb(prob, grid, params)

    bs, deriv = basic_state(grid, params)

    N  = params.Ny * params.Nz
    Iâ° = sparse(Matrix(1.0I, N, N))  # Identity matrix
    sâ‚ = size(Iâ°, 1);
    sâ‚‚ = size(Iâ°, 2);

    # the horizontal Laplacian operator:  âˆ‡â‚•Â² = âˆ‚Ê¸Ê¸ - kÂ²
    âˆ‡â‚•Â² = SparseMatrixCSC(Zeros(N, N))
    âˆ‡â‚•Â² = (1.0 * prob.DÂ²Ê¸ - 1.0 * params.k^2 * Iâ°)

    # some quantities required later
    bs_âˆ‚á¶»Bâ‚€â»Â¹  = @. 1.0/deriv.âˆ‚á¶»Bâ‚€
    bs_âˆ‚á¶»Bâ‚€â»Â²  = @. 1.0/(deriv.âˆ‚á¶»Bâ‚€ * deriv.âˆ‚á¶»Bâ‚€)

    âˆ‚á¶»Bâ‚€â»Â¹::Array{Float64, 2} = SparseMatrixCSC(Zeros(N, N))
    âˆ‚á¶»Bâ‚€â»Â²::Array{Float64, 2} = SparseMatrixCSC(Zeros(N, N))
    âˆ‚Ê¸Qâ‚€::Array{Float64, 2}   = SparseMatrixCSC(Zeros(N, N)) # PV gradient is zero

    # converting to matrics
    âˆ‚á¶»Bâ‚€â»Â¹[diagind(âˆ‚á¶»Bâ‚€â»Â¹)] = bs_âˆ‚á¶»Bâ‚€â»Â¹
    âˆ‚á¶»Bâ‚€â»Â²[diagind(âˆ‚á¶»Bâ‚€â»Â²)] = bs_âˆ‚á¶»Bâ‚€â»Â²

    # definition of perturbation PV, q = Dâ‚‚Â³áµˆ{Ïˆ}
    Dâ‚‚Â³áµˆ = (1.0 * âˆ‡â‚•Â²
            + 1.0  * âˆ‚á¶»Bâ‚€â»Â¹ * prob.DÂ²á¶»
            - 1.0  * bs.fields.âˆ‚á¶»á¶»Bâ‚€  * âˆ‚á¶»Bâ‚€â»Â² * prob.Dá¶»)

    # Construct the matrix `A`
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # 1) Now define your 1Ã—1 block-rows in a NamedTuple of 1-tuples
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # Construct the matrix `A`
    Ablocks = (
        Ïˆ = (  # Ïˆ-equation
                sparse(1.0im * params.k * bs.fields.Uâ‚€ * Dâ‚‚Â³áµˆ
                    + 1.0im * params.k * âˆ‚Ê¸Qâ‚€
                    - 1.0 * params.E * âˆ‡â‚•Â² * Dâ‚‚Â³áµˆ
                )
        ),
    )

    # Construct the matrix `B`
    Bblocks = (
        Ïˆ = (  # Ïˆ-equation: [-Dâ‚‚Â³áµˆ]
                sparse(-Dâ‚‚Â³áµˆ)
        ),
    )

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # 2) Assemble the block-row matrices into a GEVPMatrices object
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    gevp = GEVPMatrices(Ablocks, Bblocks)


    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # 3) And now you have exactly:
    #    gevp.A, gevp.B                    â†’ full sparse matrices
    #    gevp.As.w, gevp.As.Î¶, gevp.As.b   â†’ each block-row view
    #    gevp.Bs.w, gevp.Bs.Î¶, gevp.Bs.b
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

    B = SparseMatrixCSC(Zeros{ComplexF64}(sâ‚, sâ‚‚))
    C = SparseMatrixCSC(Zeros{ Float64  }(sâ‚, sâ‚‚))

    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    # 4) Implementing boundary conditions
    # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    _, zi = ndgrid(1:1:params.Ny, 1:1:params.Nz)
    zi    = transpose(zi);
    zi    = zi[:];
    bcá¶»â»  = findall( x -&gt; (x==1),         zi )      ## @ z=0
    bcá¶»âº  = findall( x -&gt; (x==params.Nz), zi )      ## @ z=1

    # Implementing boundary condition for ğ“› matrix in the z-direction:
    B[:,1:1sâ‚‚] = 1.0im * params.k * bs.fields.Uâ‚€ * prob.Dá¶» - 1.0im * params.k * bs.fields.âˆ‚á¶»Uâ‚€

    # Bottom boundary condition @ z=0
    @. gevp.A[bcá¶»â», :] = B[bcá¶»â», :]

    # Top boundary condition @ z = 1
    @. gevp.A[bcá¶»âº, :] = B[bcá¶»âº, :]

    # Implementing boundary condition for â„³ matrix in the z-direction:
    C[:,1:1sâ‚‚] = -1.0 * prob.Dá¶»

    # Bottom boundary condition @ z=0
    @. gevp.B[bcá¶»â», :] = C[bcá¶»â», :]

    # Top boundary condition @ z = 1
    @. gevp.B[bcá¶»âº, :] = C[bcá¶»âº, :]

    return gevp.A, gevp.B
end</code></pre><h2 id="Eigenvalue-solver"><a class="docs-heading-anchor" href="#Eigenvalue-solver">Eigenvalue solver</a><a id="Eigenvalue-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenvalue-solver" title="Permalink"></a></h2><pre><code class="language-julia hljs">function EigSolver(prob, grid, params, Ïƒâ‚€)

    A, B = generalized_EigValProb(prob, grid, params)

    if params.eig_solver == &quot;arpack&quot;
        Î», Î§ = solve_shift_invert_arnoldi(A, B; Ïƒâ‚€=Ïƒâ‚€, which=:LR, sortby=:R)

    elseif params.eig_solver == &quot;krylov&quot;

        Î», Î§ = solve_shift_invert_krylov(A, B; Ïƒâ‚€=Ïƒâ‚€, which=:LR, sortby=:R)

    elseif params.eig_solver == &quot;arnoldi&quot;

        Î», Î§ = solve_shift_invert_arnoldi(A, B; Ïƒâ‚€=Ïƒâ‚€, which=:LR, sortby=:R)
    end
    # ======================================================================
    @assert length(Î») &gt; 0 &quot;No eigenvalue(s) found!&quot;

    @printf &quot;largest growth rate : %1.4e%+1.4eim\n&quot; real(Î»[1]) imag(Î»[1])

    return Î»[1], Î§[:,1]
end</code></pre><h2 id="Solving-the-Eady-problem"><a class="docs-heading-anchor" href="#Solving-the-Eady-problem">Solving the Eady problem</a><a id="Solving-the-Eady-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Solving-the-Eady-problem" title="Permalink"></a></h2><pre><code class="language-julia hljs">function solve_Eady(k::Float64)

    # Calling problem parameters
    params = Params{Float64}()

    # Construct grid and derivative operators
    grid  = TwoDGrid(params)

    # Construct the necesary operator
    ops  = OperatorI(params)
    prob = Problem(grid, ops)

    # update the wavenumber
    params.k = k

    # initial guess for the growth rate
    Ïƒâ‚€   = 0.02

    Î», Î§ = EigSolver(prob, grid, params, Ïƒâ‚€)

    # Analytical solution of Eady (1949) for the growth rate
    Î¼  = 1.0 * params.k * âˆšparams.Ri
    Î»â‚œ = 1.0/âˆšparams.Ri * âˆš( (coth(0.5Î¼) - 0.5Î¼)*(0.5Î¼ - tanh(0.5Î¼)) )

    @printf &quot;Analytical solution of Stone (1971) for the growth rate: %f \n&quot; Î»â‚œ

    return abs(Î».re - Î»â‚œ) &lt; 1e-3
end</code></pre><h2 id="Result"><a class="docs-heading-anchor" href="#Result">Result</a><a id="Result-1"></a><a class="docs-heading-anchor-permalink" href="#Result" title="Permalink"></a></h2><pre><code class="language-julia hljs">solve_Eady(0.1) # growth rate is at k=0.1</code></pre><pre><code class="nohighlight hljs">(attempt  1) trying Ïƒ = 0.024000
Converged: first Î» = 0.028829 + i -0.000000 (Ïƒ = 0.024000)
(attempt  2) trying Ïƒ = 0.024800
Converged: first Î» = 0.028829 + i 0.000000 (Ïƒ = 0.024800)
Successive eigenvalues converged: |Î”Î»| = 4.52e-13 &lt; 1.00e-05
largest growth rate : 2.8829e-02+2.4551e-13im
Analytical solution of Stone (1971) for the growth rate: 0.028829 
</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Stone1971/">Â« Stone1971</a><a class="docs-footer-nextpage" href="../rRBC/">rotating RBC Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Sunday 20 July 2025 14:21">Sunday 20 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
